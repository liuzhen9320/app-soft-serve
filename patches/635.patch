From 17e8153691b20b83a97cbd771d32524030fdabbc Mon Sep 17 00:00:00 2001
From: Souma <101255979+5ouma@users.noreply.github.com>
Date: Wed, 15 Jan 2025 18:21:37 +0900
Subject: [PATCH] feat(backend): Support README files in the second-depth
 directories

Many other Git platforms support them as well.
---
 pkg/backend/utils.go | 11 ++++++++++-
 1 file changed, 10 insertions(+), 1 deletion(-)

diff --git a/pkg/backend/utils.go b/pkg/backend/utils.go
index be1b0b4a7..5a3e328ef 100644
--- a/pkg/backend/utils.go
+++ b/pkg/backend/utils.go
@@ -1,6 +1,8 @@
 package backend
 
 import (
+	"fmt"
+
 	"github.com/charmbracelet/soft-serve/git"
 	"github.com/charmbracelet/soft-serve/pkg/proto"
 )
@@ -18,6 +20,13 @@ func LatestFile(r proto.Repository, ref *git.Reference, pattern string) (string,
 // Readme returns the repository's README.
 func Readme(r proto.Repository, ref *git.Reference) (readme string, path string, err error) {
 	pattern := "[rR][eE][aA][dD][mM][eE]*"
-	readme, path, err = LatestFile(r, ref, pattern)
+	directories := []string{"", "docs", ".github", ".gitlab"}
+	for _, dir := range directories {
+		pattern := fmt.Sprintf("%s/%s", dir, pattern)
+		readme, path, err = LatestFile(r, ref, pattern)
+		if err == nil {
+			break
+		}
+	}
 	return
 }
